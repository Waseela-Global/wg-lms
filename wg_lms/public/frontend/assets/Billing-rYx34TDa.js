import{a as b,o as y,e as l,l as k,t as i,f as d,w as S,u as n,q as C,i as T,x as z,z as D,c as v,aa as E,B as I,a8 as w,E as G,b as p,L as c,h as P,aI as x}from"./index-CZIp1LU6.js";import{_ as q}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";const K={class:"text-base border rounded-md w-1/3 mx-auto my-32"},H={class:"border-b px-5 py-3 font-medium text-ink-gray-9"},J={class:"px-5 py-3"},O={class:"mb-4 leading-6 text-ink-gray-7"},L={__name:"NotPermitted",props:{title:{type:String,default:"Not Permitted"},text:{type:String,default:"You are not permitted to access this page."},buttonLabel:{type:String,default:"Login"},buttonLink:{type:String,default:"/login"}},setup(u){const g=u,h=()=>{window.location.href=g.buttonLink};return(o,m)=>(y(),b("div",K,[l("div",H,[m[1]||(m[1]=l("span",{class:"inline-flex items-center before:bg-surface-red-5 before:w-2 before:h-2 before:rounded-md before:mr-2"},null,-1)),k(" "+i(o.__(u.title)),1)]),l("div",J,[l("div",O,i(o.__(u.text)),1),d(n(C),{variant:"solid",class:"w-full",onClick:m[0]||(m[0]=r=>h())},{default:S(()=>[k(i(o.__(u.buttonLabel)),1)]),_:1})])]))}},R={class:""},W={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},F={key:0,class:"pt-5 pb-10 mx-5"},Y={class:"flex flex-col lg:flex-row justify-between"},Q={class:"h-fit bg-surface-gray-2 rounded-md p-5 space-y-4 lg:order-last mb-10 lg:mt-10 font-medium lg:w-1/3"},X={class:"flex items-baseline justify-between space-y-2"},Z={class:"text-ink-gray-5"},ee={class:"leading-5 text-ink-gray-9"},te={key:0,class:"flex items-center justify-between"},se={class:"text-ink-gray-5"},le={class:"text-ink-gray-9"},ne={key:1,class:"flex items-center justify-between mt-2"},ae={class:"text-ink-gray-5"},oe={class:"text-ink-gray-9"},ie={class:"flex items-center justify-between border-t border-outline-gray-3 pt-4 mt-2"},re={class:"text-lg font-semibold text-ink-gray-9"},de={class:"text-lg font-semibold text-ink-gray-9"},ue={class:"flex-1 lg:mr-10"},me={class:"mb-5"},ce={class:"text-lg font-semibold text-ink-gray-9"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-5"},be={class:"space-y-4"},_e={class:"space-y-4"},pe={class:"flex items-center justify-between border-t pt-4 mt-8"},ge={class:"text-ink-gray-5"},fe={key:1},he={key:2},Ve={__name:"Billing",props:{type:{type:String,required:!0},name:{type:String,required:!0}},setup(u){const g=T("$user"),{brand:h}=z();D(()=>{var s;const e=document.createElement("script");e.src="https://checkout.razorpay.com/v1/checkout.js",document.body.appendChild(e),(s=g.data)!=null&&s.name&&m.submit()});const o=u,m=v({url:"wg_lms.lms.api.validate_billing_access",params:{billing_type:o.type,name:o.name},onSuccess(e){$(e.address),r.submit()}}),r=v({url:"wg_lms.lms.utils.get_order_summary",makeParams(e){return{doctype:o.type=="batch"?"LMS Batch":"LMS Course",docname:o.name,country:t.country}},onError(e){N(e)}}),t=E({}),$=e=>{t.billing_name=(e==null?void 0:e.billing_name)||"",t.address_line1=(e==null?void 0:e.address_line1)||"",t.address_line2=(e==null?void 0:e.address_line2)||"",t.city=(e==null?void 0:e.city)||"",t.state=(e==null?void 0:e.state)||"",t.country=(e==null?void 0:e.country)||"",t.pincode=(e==null?void 0:e.pincode)||"",t.phone=(e==null?void 0:e.phone)||"",t.source=(e==null?void 0:e.source)||"",t.gstin=(e==null?void 0:e.gstin)||"",t.pan=(e==null?void 0:e.pan)||""},B=v({url:"wg_lms.lms.payments.get_payment_link",makeParams(e){return{doctype:o.type=="batch"?"LMS Batch":"LMS Course",docname:o.name,title:r.data.title,amount:r.data.original_amount,total_amount:r.data.amount,currency:r.data.currency,address:t,redirect_to:A.value,payment_for_certificate:o.type=="certificate"}}}),M=()=>{B.submit({},{validate(){return t.source?j():__("Please let us know where you heard about us from.")},onSuccess(e){window.location.href=e},onError(e){var s;w.error(((s=e.messages)==null?void 0:s[0])||e)}})},j=()=>{let e=["billing_name","address_line1","city","pincode","country","phone","source"];for(let _ of e)if(!t[_])return"Please enter a valid "+_.replaceAll("_"," ").toLowerCase().replace(/\b\w/g,f=>f.toUpperCase());if(t.gstin&&!t.pan)return"Please enter a valid pan number.";if(t.country=="India"&&!t.state)return"Please enter a valid state with correct spelling and the first letter capitalized.";const s=["Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chhattisgarh","Delhi","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Karnataka","Kerala","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"];if(t.country=="India"&&!s.includes(t.state))return"Please enter a valid state with correct spelling and the first letter capitalized.";console.log("validation address")},N=e=>{var s;w.error(((s=e.messages)==null?void 0:s[0])||e)},U=e=>{t.country=e,r.reload()},A=I(()=>{if(o.type=="course")return`/lms/courses/${o.name}`;if(o.type=="batch")return`/lms/batches/${o.name}`;if(o.type=="certificate")return`/lms/courses/${o.name}/certification`});return G(()=>({title:__("Billing Details"),icon:h.favicon})),(e,s)=>{var _,f,V;return y(),b("div",R,[l("header",W,[d(n(q),{class:"h-7",items:[{label:e.__("Billing Details"),route:{name:"Billing"}}]},null,8,["items"])]),(_=n(m).data)!=null&&_.access&&n(r).data?(y(),b("div",F,[l("div",Y,[l("div",Q,[l("div",X,[l("div",Z,i(e.__("Payment for "))+" "+i(u.type)+": ",1),l("div",ee,i(n(r).data.title),1)]),n(r).data.gst_applied?(y(),b("div",te,[l("div",se,i(e.__("Original Amount")),1),l("div",le,i(n(r).data.original_amount_formatted),1)])):p("",!0),n(r).data.gst_applied?(y(),b("div",ne,[l("div",ae,i(e.__("GST Amount")),1),l("div",oe,i(n(r).data.gst_amount_formatted),1)])):p("",!0),l("div",ie,[l("div",re,i(e.__("Total")),1),l("div",de,i(n(r).data.total_amount_formatted),1)])]),l("div",ue,[l("div",me,[l("div",ce,i(e.__("Address")),1)]),l("div",ye,[l("div",be,[d(n(c),{label:e.__("Billing Name"),modelValue:t.billing_name,"onUpdate:modelValue":s[0]||(s[0]=a=>t.billing_name=a)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Address Line 1"),modelValue:t.address_line1,"onUpdate:modelValue":s[1]||(s[1]=a=>t.address_line1=a)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Address Line 2"),modelValue:t.address_line2,"onUpdate:modelValue":s[2]||(s[2]=a=>t.address_line2=a)},null,8,["label","modelValue"]),d(n(c),{label:e.__("City"),modelValue:t.city,"onUpdate:modelValue":s[3]||(s[3]=a=>t.city=a)},null,8,["label","modelValue"]),d(n(c),{label:e.__("State/Province"),modelValue:t.state,"onUpdate:modelValue":s[4]||(s[4]=a=>t.state=a)},null,8,["label","modelValue"])]),l("div",_e,[d(x,{doctype:"Country",value:t.country,onChange:s[5]||(s[5]=a=>U(a)),label:e.__("Country")},null,8,["value","label"]),d(n(c),{label:e.__("Postal Code"),modelValue:t.pincode,"onUpdate:modelValue":s[6]||(s[6]=a=>t.pincode=a)},null,8,["label","modelValue"]),d(n(c),{label:e.__("Phone Number"),modelValue:t.phone,"onUpdate:modelValue":s[7]||(s[7]=a=>t.phone=a)},null,8,["label","modelValue"]),d(x,{doctype:"LMS Source",value:t.source,onChange:s[8]||(s[8]=a=>t.source=a),label:e.__("Where did you hear about us?")},null,8,["value","label"]),t.country=="India"?(y(),P(n(c),{key:0,label:e.__("GST Number"),modelValue:t.gstin,"onUpdate:modelValue":s[9]||(s[9]=a=>t.gstin=a)},null,8,["label","modelValue"])):p("",!0),t.country=="India"?(y(),P(n(c),{key:1,label:e.__("Pan Number"),modelValue:t.pan,"onUpdate:modelValue":s[10]||(s[10]=a=>t.pan=a)},null,8,["label","modelValue"])):p("",!0)])]),l("div",pe,[l("p",ge,i(e.__("Make sure to enter the correct billing name as the same will be used in your invoice.")),1),d(n(C),{variant:"solid",size:"md",onClick:s[11]||(s[11]=a=>M())},{default:S(()=>[k(i(e.__("Proceed to Payment")),1)]),_:1})])])])])):(f=n(m).data)!=null&&f.message?(y(),b("div",fe,[d(L,{text:n(m).data.message,buttonLabel:u.type=="course"?"Checkout Course":"Checkout Batch",buttonLink:u.type=="course"?`/lms/courses/${u.name}`:`/lms/batches/${u.name}`},null,8,["text","buttonLabel","buttonLink"])])):(V=n(g).data)!=null&&V.name?p("",!0):(y(),b("div",he,[d(L,{text:"Please login to access this page.",buttonLink:`/login?redirect-to=/lms/billing/${u.type}/${u.name}`},null,8,["buttonLink"])]))])}}};export{Ve as default};
//# sourceMappingURL=Billing-rYx34TDa.js.map
