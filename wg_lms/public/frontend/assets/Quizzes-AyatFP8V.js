import{x as R,i as q,p as I,y as z,z as H,J,H as K,B as N,E as O,r as W,a as u,o as n,e as m,f as i,h as f,b as j,u as e,w as o,l as B,t as p,P as X,q as b,T as w,L as x,R as G,F as $,g as F,S as Y,U as Z,W as ee,X as ae,aK as te,Q as se,D as ie,a8 as V}from"./index-CZIp1LU6.js";import{_ as oe}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";import{_ as le}from"./EmptyState.vue_vue_type_script_setup_true_lang-Cua88j6p.js";const ne={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},re={class:"py-5 mx-5"},ue={class:"flex items-center justify-between mb-4"},de={class:"text-lg font-semibold text-ink-gray-7"},_e={key:0},ce={key:1,class:"text-xs text-ink-gray-5"},me={key:2},fe={class:"flex gap-2"},pe={key:2,class:"flex justify-center my-5"},ze={__name:"Quizzes",setup(ye){var S;const{brand:P}=R(),_=q("$user"),T=q("$dayjs"),Q=I(),y=z(""),U=window.read_only_mode,k=z({}),v=z(!1),h=z("");H(()=>{var s,a,d,c;!((s=_.data)!=null&&s.is_moderator)&&!((a=_.data)!=null&&a.is_instructor)?Q.push({name:"Courses"}):(d=_.data)!=null&&d.is_moderator||(k.value.owner=(c=_.data)==null?void 0:c.name)}),J(y,()=>{k.value.title=["like",`%${y.value}%`],r.update({filters:k.value}),r.reload()});const r=K({doctype:"LMS Quiz",filters:k,fields:["name","title","passing_percentage","total_marks","show_answers","max_attempts","modified"],auto:!0,cache:["quizzes",(S=_.data)==null?void 0:S.name],orderBy:"modified desc",transform(s){return s.map(a=>({...a,modified:T(a.modified).fromNow()}))}}),D=s=>{r.insert.submit({title:h.value},{onSuccess(a){V.success(__("Quiz created successfully")),s(),h.value="",Q.push({name:"QuizForm",params:{quizID:a.name}})},onError(a){V.error(__("Error creating quiz: {0}",a.message))}})},E=(s,a)=>{Array.from(s).forEach(async d=>{await r.delete.submit(d)}),a(),V.success(__("Quizzes deleted successfully"))},C=N(()=>[{label:__("Title"),key:"title",width:2,icon:"file-text"},{label:__("Total Marks"),key:"total_marks",width:1,align:"center",icon:"hash"},{label:__("Passing Percentage"),key:"passing_percentage",width:1,align:"center",icon:"percent"},{label:__("Max Attempts"),key:"max_attempts",width:1,align:"center",icon:"repeat"},{label:__("Show Answers"),key:"show_answers",width:1,align:"center",icon:"eye"},{label:__("Modified"),key:"modified",width:1,align:"center",icon:"clock"}]),L=N(()=>[{label:__("Quizzes"),route:{name:"Quizzes"}}]);return O(()=>({title:__("Quizzes"),icon:P.favicon})),(s,a)=>{var c,M;const d=W("router-link");return n(),u($,null,[m("header",ne,[i(e(oe),{items:L.value},null,8,["items"]),e(U)?j("",!0):(n(),f(e(b),{key:0,variant:"solid",onClick:a[0]||(a[0]=t=>v.value=!0)},{prefix:o(()=>[i(e(X),{class:"w-4 h-4"})]),default:o(()=>[B(" "+p(s.__("Create")),1)]),_:1}))]),m("div",re,[m("div",ue,[m("div",de,p((c=e(r).data)!=null&&c.length?s.__("{0} Quizzes").format(e(r).data.length):s.__("No Quizzes")),1),i(e(x),{modelValue:y.value,"onUpdate:modelValue":a[1]||(a[1]=t=>y.value=t),type:"text",placeholder:"Search"},{prefix:o(()=>[i(e(w),{name:"search",class:"size-4 text-ink-gray-5"})]),_:1},8,["modelValue"])]),(M=e(r).data)!=null&&M.length?(n(),f(e(se),{key:0,columns:C.value,rows:e(r).data,"row-key":"name",options:{showTooltip:!1,selectable:!0}},{default:o(()=>[i(e(G),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:o(()=>[(n(!0),u($,null,F(C.value,t=>(n(),f(e(Y),{item:t},{prefix:o(({item:l})=>{var g;return[i(e(w),{name:(g=l.icon)==null?void 0:g.toString(),class:"h-4 w-4"},null,8,["name"])]}),_:2},1032,["item"]))),256))]),_:1}),i(e(Z),null,{default:o(()=>[(n(!0),u($,null,F(e(r).data,t=>(n(),f(d,{to:{name:"QuizForm",params:{quizID:t.name}}},{default:o(()=>[i(e(ee),{row:t},{default:o(({column:l,item:g})=>[i(e(ae),{item:t[l.key],align:l.align},{default:o(()=>[l.key=="show_answers"?(n(),u("div",_e,[i(e(x),{type:"checkbox",modelValue:t[l.key],"onUpdate:modelValue":A=>t[l.key]=A,disabled:!0},null,8,["modelValue","onUpdate:modelValue"])])):l.key=="modified"?(n(),u("div",ce,p(t[l.key]),1)):(n(),u("div",me,p(t[l.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),i(e(te),null,{actions:o(({unselectAll:t,selections:l})=>[m("div",fe,[i(e(b),{variant:"ghost",onClick:g=>E(l,t)},{default:o(()=>[i(e(w),{name:"trash-2",class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(n(),f(le,{key:1,type:"Quizzes"})),e(r).hasNextPage?(n(),u("div",pe,[i(e(b),{onClick:a[2]||(a[2]=t=>e(r).next())},{default:o(()=>[B(p(s.__("Load More")),1)]),_:1})])):j("",!0)]),i(e(ie),{modelValue:v.value,"onUpdate:modelValue":a[4]||(a[4]=t=>v.value=t),options:{title:s.__("Create a Quiz"),size:"sm",actions:[{label:s.__("Save"),variant:"solid",onClick({close:t}){D(t)}}]}},{"body-content":o(()=>[i(e(x),{modelValue:h.value,"onUpdate:modelValue":a[3]||(a[3]=t=>h.value=t),label:s.__("Title"),type:"text"},null,8,["modelValue","label"])]),_:1},8,["modelValue","options"])],64)}}};export{ze as default};
//# sourceMappingURL=Quizzes-AyatFP8V.js.map
