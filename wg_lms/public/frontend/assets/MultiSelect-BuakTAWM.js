import{s as E,v as P,cI as T,y as p,B as _,cJ as A,c as I,a as u,o,b as g,e as r,n as F,l as U,t as x,f as d,w as m,u as l,bH as H,bM as J,cK as X,F as N,g as S,h as G,cL as Q,q as W,P as Y,bN as Z,cM as R,cC as ee,bL as te,cN as se,bA as ae,ar as le}from"./index-CZIp1LU6.js";const oe={key:0,class:"text-ink-red-3"},re={class:"w-full"},ue={class:"mt-1 rounded-lg bg-surface-white py-1 text-base border-2"},ne={class:"flex flex-col gap-1 p-1"},ie={class:"text-base font-medium text-ink-gray-8"},ce={class:"text-sm text-ink-gray-5"},de={key:0,class:"absolute bottom-2 left-1 w-[99%] pt-2 bg-white border-t"},fe={key:1,class:"grid grid-cols-2 gap-2 mt-1"},pe={class:"flex items-center justify-between break-all bg-surface-gray-2 text-ink-gray-7 word-wrap p-2 rounded-md mr-2"},me={class:"break-all"},ye={__name:"MultiSelect",props:E({label:{type:String},size:{type:String,default:"sm"},doctype:{type:String,required:!0},filters:{type:Object,default:()=>({})},validate:{type:Function,default:null},errorMessage:{type:Function,default:n=>`${n} is an Invalid value`},required:{type:Boolean}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n,{expose:B}){const i=n,a=P(n,"modelValue"),V=T(),y=p([]),C=p(null),k=p(null),f=p(""),b=p(""),h=p(!1),M=_({get:()=>f.value||"",set:e=>{f.value="",e&&(h.value=!1),e!=null&&e.value&&K(e.value)}});A(f,e=>{e=e||"",b.value!==e&&(b.value=e,z(e))},{debounce:300,immediate:!0});const w=I({url:"frappe.desk.search.search_link",method:"POST",cache:[b.value,i.doctype],auto:!0,params:{txt:b.value,doctype:i.doctype}}),q=_(()=>w.data||[]);function z(e){w.update({params:{txt:e,doctype:i.doctype}}),w.reload()}const K=e=>{k.value=null,e&&(e.split(",").forEach(t=>{var c;if(t=t.trim(),t&&!((c=a.value)!=null&&c.includes(t))){if(t&&i.validate&&!i.validate(t)){k.value=i.errorMessage(t);return}a.value?a.value.push(t):a.value=[t],t=t.replace(t,"")}}),!k.value&&(e=""))},L=e=>{a.value=a.value.filter(s=>s!==e)},O=()=>{var s;if(f.value)return;let e=(s=y.value[y.value.length-1])==null?void 0:s.$el;document.activeElement===e?(a.value.pop(),le(()=>{a.value.length?(e=y.value[y.value.length-1].$el,e==null||e.focus()):$()})):e==null||e.focus()};function $(){C.value.$el.focus()}B({setFocus:$});const j=_(()=>[{sm:"text-xs",md:"text-base"}[i.size||"sm"],"text-ink-gray-5"]);return(e,s)=>(o(),u("div",null,[n.label?(o(),u("label",{key:0,class:F(["block mb-1",j.value])},[U(x(n.label)+" ",1),n.required?(o(),u("span",oe,"*")):g("",!0)],2)):g("",!0),r("div",re,[d(l(se),{modelValue:M.value,"onUpdate:modelValue":s[2]||(s[2]=t=>M.value=t),nullable:""},{default:m(()=>[d(l(H),{class:"w-full",show:h.value,"onUpdate:show":s[1]||(s[1]=t=>h.value=t)},{target:m(({togglePopover:t})=>[d(l(R),{ref_key:"search",ref:C,class:"search-input form-input w-full focus-visible:!ring-0",type:"text",value:f.value,onChange:s[0]||(s[0]=c=>{f.value=c.target.value,h.value=!0}),autocomplete:"off",onFocus:()=>t(),onKeydownCapture:ee(te(O,["stop"]),["delete"])},null,8,["value","onFocus","onKeydownCapture"])]),body:m(({isOpen:t,close:c})=>[J(r("div",null,[r("div",ue,[d(l(X),{class:"my-1 min-h-[6rem] max-h-[12rem] overflow-y-auto px-1.5",static:""},{default:m(()=>[(o(!0),u(N,null,S(q.value,v=>(o(),G(l(Q),{key:v.value,value:v},{default:m(({active:D})=>[r("li",{class:F(["flex cursor-pointer items-center rounded px-2 py-1 text-base",{"bg-surface-gray-2":D}])},[r("div",ne,[r("div",ie,x(v.description),1),r("div",ce,x(v.value),1)])],2)]),_:2},1032,["value"]))),128)),s[3]||(s[3]=r("div",{class:"h-10"},null,-1)),l(V).onCreate?(o(),u("div",de,[d(l(W),{variant:"ghost",class:"w-full !justify-start",label:e.__("Create New"),onClick:v=>l(V).onCreate(c)},{prefix:m(()=>[d(l(Y),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["label","onClick"])])):g("",!0)]),_:2},1024)])],512),[[Z,t]])]),_:1},8,["show"])]),_:1},8,["modelValue"])]),a.value.length?(o(),u("div",fe,[(o(!0),u(N,null,S(a.value,t=>(o(),u("div",pe,[r("span",me,x(t),1),d(l(ae),{class:"size-4 stroke-1.5 cursor-pointer",onClick:c=>L(t)},null,8,["onClick"])]))),256))])):g("",!0)]))}};export{ye as _};
//# sourceMappingURL=MultiSelect-BuakTAWM.js.map
