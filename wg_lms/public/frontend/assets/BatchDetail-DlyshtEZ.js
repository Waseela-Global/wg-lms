import{p as L,i as E,c as N,B as y,r as T,a as l,b as d,o as s,f as i,e as n,n as O,l as C,t as o,u as t,aD as j,a4 as H,j as P,k as S,aC as F,h,w as u,q as p,aw as G,aE as I,a0 as R,G as q,a3 as A,a8 as Y,x as J,E as K,F as z,g as D}from"./index-CZIp1LU6.js";import{_ as Q}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";import{_ as U}from"./CourseCard-Dy3xQuBt.js";import{_ as W}from"./DateRange-CMguaU_1.js";import{_ as X}from"./CourseInstructors-Dfde5EU7.js";import{_ as Z}from"./UserAvatar-D_gN1iLa.js";const tt={key:0,class:"border-2 rounded-md p-5 lg:w-72"},at={key:0},et={key:1},st={key:1,class:"text-xs bg-red-100 text-red-700 float-right px-2 py-0.5 rounded-md"},rt={key:2,class:"text-lg font-semibold mb-3 text-ink-gray-9"},nt={key:3,class:"flex items-center mb-3 text-ink-gray-7"},ot={class:"flex items-center mb-3 text-ink-gray-7"},ct={key:4,class:"flex items-center text-ink-gray-7"},lt={key:5},M={__name:"BatchOverlay",props:{batch:{type:Object,default:null}},setup(e){const x=L(),k=E("$user"),g=window.read_only_mode,a=e,w=N({url:"wg_lms.lms.utils.enroll_in_batch",makeParams(r){return{batch:a.batch.data.name}}}),B=()=>{k.data||(window.location.href=`/login?redirect-to=/batches/details/${a.batch.data.name}`),w.submit({},{onSuccess(r){Y.success(__("You have been enrolled in this batch")),x.push({name:"Batch",params:{batchName:a.batch.data.name}})}})},c=y(()=>{var r,f,m,$;return(r=a.batch.data)!=null&&r.seat_count?((f=a.batch.data)==null?void 0:f.seat_count)-(($=(m=a.batch.data)==null?void 0:m.students)==null?void 0:$.length):null}),b=y(()=>{var r,f,m;return(m=(r=a.batch.data)==null?void 0:r.students)==null?void 0:m.includes((f=k.data)==null?void 0:f.name)}),v=y(()=>{var r;return(r=k.data)==null?void 0:r.is_moderator}),_=y(()=>{var r;return(r=k.data)==null?void 0:r.is_evaluator}),V=y(()=>v.value||b.value||_.value);return(r,f)=>{const m=T("router-link");return e.batch.data?(s(),l("div",tt,[e.batch.data.seat_count&&c.value>0?(s(),l("div",{key:0,class:O(["text-sm bg-green-100 text-green-700 px-2 py-1 rounded-md",e.batch.data.amount||e.batch.data.courses.length?"float-right":"w-fit mb-4"])},[C(o(c.value)+" ",1),c.value>1?(s(),l("span",at,o(r.__("Seats Left")),1)):c.value==1?(s(),l("span",et,o(r.__("Seat Left")),1)):d("",!0)],2)):e.batch.data.seat_count&&c.value<=0?(s(),l("div",st,o(r.__("Sold Out")),1)):d("",!0),e.batch.data.amount?(s(),l("div",rt,o(t(j)(e.batch.data.amount,e.batch.data.currency)),1)):d("",!0),e.batch.data.courses.length?(s(),l("div",nt,[i(t(H),{class:"h-4 w-4 stroke-1.5 mr-2"}),n("span",null,o(e.batch.data.courses.length)+" "+o(r.__("Courses")),1)])):d("",!0),i(W,{startDate:e.batch.data.start_date,endDate:e.batch.data.end_date,class:"mb-3"},null,8,["startDate","endDate"]),n("div",ot,[i(t(P),{class:"h-4 w-4 stroke-1.5 mr-2"}),n("span",null,o(t(S)(e.batch.data.start_time))+" - "+o(t(S)(e.batch.data.end_time)),1)]),e.batch.data.timezone?(s(),l("div",ct,[i(t(F),{class:"h-4 w-4 stroke-1.5 mr-2"}),n("span",null,o(e.batch.data.timezone),1)])):d("",!0),t(g)?d("",!0):(s(),l("div",lt,[V.value?(s(),h(m,{key:0,to:{name:"Batch",params:{batchName:e.batch.data.name}}},{default:u(()=>[i(t(p),{variant:"solid",class:"w-full mt-4"},{prefix:u(()=>[b.value?(s(),h(t(G),{key:0,class:"size-4 stroke-1.5"})):(s(),h(t(I),{key:1,class:"size-4 stroke-1.5"}))]),default:u(()=>[n("span",null,o(b.value?r.__("Visit Batch"):r.__("Manage Batch")),1)]),_:1})]),_:1},8,["to"])):e.batch.data.paid_batch&&e.batch.data.seats_left>0&&e.batch.data.accept_enrollments?(s(),h(m,{key:1,to:{name:"Billing",params:{type:"batch",name:e.batch.data.name}}},{default:u(()=>[b.value?d("",!0):(s(),h(t(p),{key:0,class:"w-full mt-4",variant:"solid"},{prefix:u(()=>[i(t(R),{class:"size-4 stroke-1.5"})]),default:u(()=>[n("span",null,o(r.__("Register Now")),1)]),_:1}))]),_:1},8,["to"])):e.batch.data.allow_self_enrollment&&e.batch.data.seats_left&&e.batch.data.accept_enrollments?(s(),h(t(p),{key:2,variant:"solid",class:"w-full mt-2",onClick:f[0]||(f[0]=$=>B())},{prefix:u(()=>[i(t(q),{class:"size-4 stroke-1.5"})]),default:u(()=>[C(" "+o(r.__("Enroll Now")),1)]),_:1})):d("",!0),v.value?(s(),h(m,{key:3,to:{name:"BatchForm",params:{batchName:e.batch.data.name}}},{default:u(()=>[i(t(p),{class:"w-full mt-2"},{prefix:u(()=>[i(t(A),{class:"size-4 stroke-1.5"})]),default:u(()=>[n("span",null,o(r.__("Edit")),1)]),_:1})]),_:1},8,["to"])):d("",!0)]))])):d("",!0)}}},dt={key:0,class:""},it={class:"sticky top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},ut={class:"m-5 pb-10"},mt={class:"flex justify-between w-full"},ht={class:"md:w-2/3"},bt={class:"text-3xl font-semibold text-ink-gray-9"},_t={class:"my-3 leading-6 text-ink-gray-7"},ft={class:"flex avatar-group overlap"},vt=["innerHTML"],kt={class:"hidden md:block"},gt={key:0},yt={class:"flex items-center mt-10"},pt={class:"text-2xl font-semibold"},xt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-5"},wt={key:0},Bt=["innerHTML"],Mt={__name:"BatchDetail",props:{batchName:{type:String,required:!0}},setup(e){E("$user");const x=L(),{brand:k}=J(),g=e,a=N({url:"wg_lms.lms.utils.get_batch_details",cache:["batch",g.batchName],params:{batch:g.batchName},auto:!0,onSuccess:c=>{c||x.push({name:"Batches"})}}),w=N({url:"wg_lms.lms.utils.get_batch_courses",params:{batch:g.batchName},cache:["batchCourses",g.batchName],auto:!0}),B=y(()=>{var b,v;let c=[{label:"Batches",route:{name:"Batches"}}];return c.push({label:(b=a==null?void 0:a.data)==null?void 0:b.title,route:{name:"BatchDetail",params:{batchName:(v=a==null?void 0:a.data)==null?void 0:v.name}}}),c});return K(()=>{var c;return{title:(c=a==null?void 0:a.data)==null?void 0:c.title,icon:k.favicon}}),(c,b)=>{const v=T("router-link");return t(a).data?(s(),l("div",dt,[n("header",it,[i(t(Q),{items:B.value},null,8,["items"])]),n("div",ut,[n("div",mt,[n("div",ht,[n("div",bt,o(t(a).data.title),1),n("div",_t,o(t(a).data.description),1),n("div",ft,[n("div",{class:O(["h-6 mr-1",{"avatar-group overlap":t(a).data.instructors.length>1}])},[(s(!0),l(z,null,D(t(a).data.instructors,_=>(s(),h(Z,{user:_},null,8,["user"]))),256))],2),i(X,{instructors:t(a).data.instructors},null,8,["instructors"])]),i(M,{batch:t(a),class:"md:hidden mt-5"},null,8,["batch"]),n("div",{class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-10",innerHTML:t(a).data.batch_details},null,8,vt)]),n("div",kt,[i(M,{batch:t(a)},null,8,["batch"])])]),t(a).data.courses.length?(s(),l("div",gt,[n("div",yt,[n("div",pt,o(c.__("Courses")),1)]),n("div",xt,[t(a).data.courses?(s(!0),l(z,{key:0},D(t(w).data,_=>(s(),l("div",{key:_.course},[i(v,{to:{name:"CourseDetail",params:{courseName:_.name}}},{default:u(()=>[(s(),h(U,{course:_,key:_.name},null,8,["course"]))]),_:2},1032,["to"])]))),128)):d("",!0)]),t(a).data.batch_details_raw?(s(),l("div",wt,[n("div",{innerHTML:t(a).data.batch_details_raw,class:"batch-description"},null,8,Bt)])):d("",!0)])):d("",!0)])])):d("",!0)}}};export{Mt as default};
//# sourceMappingURL=BatchDetail-DlyshtEZ.js.map
