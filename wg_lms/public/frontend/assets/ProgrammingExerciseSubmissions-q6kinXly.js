import{d as U,x as T,i as V,y as z,p as D,z as I,B as g,H as A,J as K,E as H,r as J,a as d,o as l,e as f,f as r,u as s,h as p,b as v,t as y,aI as w,L as O,w as m,R as Q,F as h,g as F,S as W,T as X,U as Y,W as G,X as Z,a1 as ee,l as R,Y as se,aK as ae,q as C,am as te,Q as re,a8 as ie}from"./index-CZIp1LU6.js";import{_ as oe}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";import{_ as le}from"./EmptyState.vue_vue_type_script_setup_true_lang-Cua88j6p.js";const ne={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},me={class:"p-6"},ue={class:"flex items-center justify-between space-x-32 mb-5"},de={class:"text-xl font-semibold text-ink-gray-7"},ce={key:0,class:"grid grid-cols-3 gap-5 flex-1"},_e={key:0},fe={key:0},ye={key:1,class:"text-sm text-ink-gray-5"},be={key:2},pe={class:"flex gap-2"},ge={key:2,class:"flex justify-center my-5"},$e=U({__name:"ProgrammingExerciseSubmissions",setup(ve){const{brand:M}=T(),q=V("$dayjs"),b=V("$user"),k=["exercise","member","status"],n=z({exercise:"",member:"",status:""}),c=D();I(()=>{B(),N()});const B=()=>{k.forEach(e=>{c.currentRoute.value.query[e]&&(n.value[e]=c.currentRoute.value.query[e])})},N=()=>{var e;x.value?n.value.member=(e=b.data)==null?void 0:e.name:i.reload()},i=A({doctype:"LMS Programming Exercise Submission",fields:["name","exercise","exercise_title","member_name","member_image","status","modified"],orderBy:"modified desc",transform(e){return e.map(a=>({...a,modified:q(a.modified).fromNow()}))}});K(n.value,()=>{let e={};k.forEach(a=>{if(n.value[a])e[a]=n.value[a],c.push({query:{...c.currentRoute.value.query,[a]:n.value[a]}});else{delete e[a];const u={...c.currentRoute.value.query};delete u[a],c.push({query:u})}}),i.update({filters:{...e}}),i.reload()});const j=(e,a)=>{Array.from(e).forEach(async u=>{await i.delete.submit(u)}),a(),ie.success(__("Submissions deleted successfully"))},x=g(()=>{var e,a,u;return!((e=b.data)!=null&&e.is_instructor)&&!((a=b.data)!=null&&a.is_moderator)&&!((u=b.data)!=null&&u.is_evaluator)}),$=g(()=>[{label:__("Member"),key:"member_name",width:"30%",icon:"user"},{label:__("Exercise"),key:"exercise_title",width:"30%",icon:"code"},{label:__("Status"),key:"status",width:"20%",icon:"check-circle"},{label:__("Modified"),key:"modified",width:"15%",icon:"clock",align:"right"}]),L=g(()=>[{label:__("Programming Exercise Submissions"),route:{name:"ProgrammingExerciseSubmissions"}}]);return H(()=>({title:__("Programming Exercises"),icon:M.favicon})),(e,a)=>{var S,E,P;const u=J("router-link");return l(),d(h,null,[f("header",ne,[r(s(oe),{items:L.value},null,8,["items"])]),f("div",me,[f("div",ue,[f("div",de,y((S=s(i).data)!=null&&S.length?e.__("{0} Submissions").format(s(i).data.length):e.__("No Submissions")),1),(E=s(i).data)!=null&&E.length?(l(),d("div",ce,[r(w,{doctype:"LMS Programming Exercise",modelValue:n.value.exercise,"onUpdate:modelValue":a[0]||(a[0]=t=>n.value.exercise=t),placeholder:e.__("Filter by Exercise")},null,8,["modelValue","placeholder"]),r(w,{doctype:"User",modelValue:n.value.member,"onUpdate:modelValue":a[1]||(a[1]=t=>n.value.member=t),placeholder:e.__("Filter by Member"),readonly:x.value},null,8,["modelValue","placeholder","readonly"]),r(s(O),{modelValue:n.value.status,"onUpdate:modelValue":a[2]||(a[2]=t=>n.value.status=t),type:"select",options:[{label:e.__(""),value:""},{label:e.__("Passed"),value:"Passed"},{label:e.__("Failed"),value:"Failed"}],placeholder:e.__("Filter by Status")},null,8,["modelValue","options","placeholder"])])):v("",!0)]),s(i).loading||(P=s(i).data)!=null&&P.length?(l(),p(s(re),{key:0,columns:$.value,rows:s(i).data,rowKey:"name",options:{selectable:!0}},{default:m(()=>[r(s(Q),{class:"mb-2 grid items-center space-x-4 rounded bg-surface-gray-2 p-2"},{default:m(()=>[(l(!0),d(h,null,F($.value,t=>(l(),p(s(W),{item:t,key:t.key},{prefix:m(({item:o})=>{var _;return[r(s(X),{name:(_=o.icon)==null?void 0:_.toString(),class:"h-4 w-4"},null,8,["name"])]}),_:2},1032,["item"]))),128))]),_:1}),r(s(Y),null,{default:m(()=>[(l(!0),d(h,null,F(s(i).data,t=>(l(),p(u,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:t.exercise,submissionID:t.name}}},{default:m(()=>[r(s(G),{row:t},{default:m(({column:o,item:_})=>[r(s(Z),{item:t[o.key],align:o.align},{prefix:m(()=>[o.key=="member_name"?(l(),d("div",_e,[r(s(se),{class:"flex items-center",image:t.member_image,label:_,size:"sm"},null,8,["image","label"])])):v("",!0)]),default:m(()=>[o.key=="status"?(l(),d("div",fe,[r(s(ee),{theme:t[o.key]==="Passed"?"green":"red"},{default:m(()=>[R(y(t[o.key]),1)]),_:2},1032,["theme"])])):o.key=="modified"?(l(),d("div",ye,y(t[o.key]),1)):(l(),d("div",be,y(t[o.key]),1))]),_:2},1032,["item","align"])]),_:2},1032,["row"])]),_:2},1032,["to"]))),256))]),_:1}),r(s(ae),null,{actions:m(({unselectAll:t,selections:o})=>[f("div",pe,[r(s(C),{variant:"ghost",onClick:_=>j(o,t)},{default:m(()=>[r(s(te),{class:"h-4 w-4 stroke-1.5"})]),_:1},8,["onClick"])])]),_:1})]),_:1},8,["columns","rows"])):(l(),p(le,{key:1,type:"Programming Exercise Submissions"})),s(i).data&&s(i).hasNextPage?(l(),d("div",ge,[r(s(C),{onClick:a[3]||(a[3]=t=>s(i).next())},{default:m(()=>[R(y(e.__("Load More")),1)]),_:1})])):v("",!0)])],64)}}});export{$e as default};
//# sourceMappingURL=ProgrammingExerciseSubmissions-q6kinXly.js.map
