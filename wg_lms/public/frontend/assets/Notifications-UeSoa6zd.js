import{aF as j,h as m,o as s,w as f,bE as F,aG as H,aJ as P,x as z,i as E,y as D,p as q,z as G,H as L,B as V,c as M,b2 as J,E as W,a as u,e as n,f as d,u as a,b as h,l as U,t as b,q as B,F as T,g as X,Y,bA as I,bL as K}from"./index-CZIp1LU6.js";import{_ as O}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";import{T as Q}from"./TabButtons-B8hLfXVF.js";const Z={props:["to"],computed:{attributes(){return{...this.$attrs,target:this.isExternal?"_blank":null,to:this.isExternal?void 0:this.to,href:this.isExternal?this.to:void 0}},isExternal(){return this.to.startsWith("http")}}};function ee(x,v,r,_,i,l){return s(),m(P(l.isExternal?"a":"router-link"),H(l.attributes,{class:"cursor-pointer text-blue-500 hover:text-blue-600"}),{default:f(()=>[F(x.$slots,"default")]),_:3},16)}const te=j(Z,[["render",ee]]),ae={class:"sticky top-0 z-10 flex flex-col md:flex-row md:items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},se={class:"flex items-center space-x-2"},ne={class:"w-full md:w-3/4 mx-auto px-5 pt-6 divide-y"},ie={class:"flex items-center"},oe=["innerHTML"],re={class:"flex items-center space-x-2"},le={key:1,class:"text-ink-gray-5"},me={__name:"Notifications",setup(x){var w,C;const{brand:v}=z(),r=E("$user"),_=E("$socket"),i=D("Unread"),l=q();G(()=>{r.data||l.push({name:"Courses"}),_.on("publish_lms_notifications",t=>{o.reload()})});const y=V(()=>i.value==="Unread"?o.data:p.data),o=L({doctype:"Notification Log",url:"wg_lms.lms.api.get_notifications",filters:{for_user:(w=r.data)==null?void 0:w.name,read:0},auto:!0,cache:"Unread Notifications"}),p=L({doctype:"Notification Log",url:"wg_lms.lms.api.get_notifications",filters:{for_user:(C=r.data)==null?void 0:C.name,read:1},auto:!0,cache:"Read Notifications"}),A=M({url:"wg_lms.lms.api.mark_as_read",makeParams(t){return{name:t.name}},onSuccess(t){o.reload(),p.reload()}}),g=M({url:"wg_lms.lms.api.mark_all_as_read",onSuccess(t){o.reload(),p.reload()}}),N=(t,c)=>{A.submit({name:c})};J(()=>{_.off("publish_lms_notifications")});const S=V(()=>[{label:"Notifications",route:{name:"Notifications"}}]);return W(()=>({title:"Notifications",icon:v.favicon})),(t,c)=>{var $,R;return s(),u(T,null,[n("header",ae,[d(a(O),{items:S.value},null,8,["items"]),n("div",se,[i.value==="Unread"&&(($=a(o).data)==null?void 0:$.length)>0?(s(),m(a(B),{key:0,onClick:a(g).submit,loading:a(g).loading},{default:f(()=>[U(b(t.__("Mark all as read")),1)]),_:1},8,["onClick","loading"])):h("",!0),d(a(Q),{class:"inline-block",buttons:[{label:"Unread",active:!0},{label:"Read"}],modelValue:i.value,"onUpdate:modelValue":c[0]||(c[0]=e=>i.value=e)},null,8,["modelValue"])])]),n("div",ne,[(R=y.value)!=null&&R.length?(s(!0),u(T,{key:0},X(y.value,e=>(s(),u("div",{key:e.name,class:"flex items-center py-2 justify-between"},[n("div",ie,[d(a(Y),{image:e.user_image,label:e.full_name,class:"mr-2"},null,8,["image","label"]),n("div",{class:"notification text-ink-gray-7",innerHTML:e.subject},null,8,oe)]),n("div",re,[e.link?(s(),m(a(te),{key:0,to:e.link,onClick:k=>N(k,e.name),class:"text-ink-gray-5 font-medium text-sm hover:text-ink-gray-7"},{default:f(()=>[U(b(t.__("View")),1)]),_:1},8,["to","onClick"])):h("",!0),e.read?h("",!0):(s(),m(a(B),{key:1,variant:"ghost",onClick:K(k=>N(k,e.name),["stop"])},{icon:f(()=>[d(a(I),{class:"h-4 w-4 text-ink-gray-7 stroke-1.5"})]),_:1},8,["onClick"]))])]))),128)):(s(),u("div",le,b(t.__("Nothing to see here.")),1))])],64)}}};export{me as default};
//# sourceMappingURL=Notifications-UeSoa6zd.js.map
