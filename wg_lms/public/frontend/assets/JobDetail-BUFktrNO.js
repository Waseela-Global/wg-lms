import{s as E,y as q,v as B,i as A,c as M,h as f,o as p,w as i,e as s,a as y,t as n,f as l,u as e,by as O,q as w,l as m,ci as R,bz as H,D as W,a8 as N,x as Y,E as G,r as I,b as x,a3 as K,ct as Q,cu as X,bO as Z,a1 as h,cv as ee,cw as te,cx as ae,cy as se,ab as oe}from"./index-CZIp1LU6.js";import{_ as ie}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";const le={class:"flex flex-col gap-4"},ne={class:"text-ink-gray-9"},re={key:0},de={class:""},ce={key:1,class:"flex items-center"},pe={class:"border rounded-md p-2 mr-2"},ue={class:"flex flex-col"},me={class:"text-ink-gray-9"},_e={class:"text-sm text-ink-gray-4 mt-1"},be={__name:"JobApplicationModal",props:E({job:{type:String,required:!0}},{modelValue:{},modelModifiers:{},application:{},applicationModifiers:{}}),emits:["update:modelValue","update:application"],setup(v){const u=q(null),j=B(v,"modelValue"),V=A("$user"),g=B(v,"application"),$=v,z=c=>{if(c.name.split(".").pop().toLowerCase()!="pdf")return"Only PDF file is allowed"},a=M({url:"frappe.client.insert",makeParams(c){var d,r;return{doc:{doctype:"LMS Job Application",user:(d=V.data)==null?void 0:d.name,resume:(r=u.value)==null?void 0:r.file_name,job:$.job}}}}),_=c=>{a.submit({},{validate(){if(!u.value)return"Please upload your resume"},onSuccess(){N.success("Your application has been submitted successfully"),g.value.reload(),c()},onError(d){var r;N.error(((r=d.messages)==null?void 0:r[0])||d)}})};return(c,d)=>(p(),f(e(W),{modelValue:j.value,"onUpdate:modelValue":d[1]||(d[1]=r=>j.value=r),class:"text-base",options:{title:c.__("Apply for this job"),size:"lg",actions:[{label:"Submit",variant:"solid",onClick:r=>{_(r)}}]}},{"body-content":i(()=>[s("div",le,[s("p",ne,n(c.__("Submit your resume to proceed with your application for this position. Upon submission, it will be shared with the job poster.")),1),u.value?(p(),y("div",ce,[s("div",pe,[l(e(R),{class:"h-5 w-5 stroke-1.5 text-ink-gray-7"})]),s("div",ue,[s("span",me,n(u.value.file_name),1),s("span",_e,n(e(H)(u.value.file_size)),1)])])):(p(),y("div",re,[l(e(O),{fileTypes:[".pdf"],validateFile:z,onSuccess:d[0]||(d[0]=r=>{u.value=r})},{default:i(({file:r,progress:S,uploading:o,openFileSelector:t})=>[s("div",de,[l(e(w),{onClick:t,loading:o},{default:i(()=>[m(n(o?`Uploading ${S}%`:"Upload your resume"),1)]),_:2},1032,["onClick","loading"])])]),_:1})]))])]),_:1},8,["modelValue","options"]))}},fe={class:""},ye={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ve={key:0,class:"flex items-center space-x-2"},ge={key:1},ke={key:0,class:"max-w-3xl mx-auto pt-5"},xe={class:"p-4"},he={class:"space-y-5 mb-12"},we={class:"flex"},je=["src","alt"],$e={class:""},ze={class:"text-2xl text-ink-gray-9 font-semibold mb-1"},Se={class:"text-sm text-ink-gray-5 font-semibold"},Ce={class:"space-x-2"},Me={class:"flex items-center justify-between"},Ve=["innerHTML"],Ue={__name:"JobDetail",props:{job:{type:String,required:!0}},setup(v){const u=A("$user"),j=A("$dayjs"),{brand:V}=Y(),g=q(!1),$=window.read_only_mode,z=v,a=M({url:"wg_lms.lms.api.get_job_details",params:{job:z.job},cache:["job",z.job],auto:!0,onSuccess:o=>{var t;(t=u.data)!=null&&t.name&&_.submit(),c.submit()}}),_=M({url:"frappe.client.get_list",makeParams(o){var t,C;return{doctype:"LMS Job Application",filters:{job:(t=a.data)==null?void 0:t.name,user:(C=u.data)==null?void 0:C.name}}}}),c=M({url:"frappe.client.get_count",makeParams(o){var t;return{doctype:"LMS Job Application",filters:{job:(t=a.data)==null?void 0:t.name}}}}),d=()=>{g.value=!0},r=o=>{window.location.href=`/login?redirect-to=/job-openings/${o}`},S=o=>{window.open(o,"_blank")};return G(()=>{var o;return{title:(o=a.data)==null?void 0:o.job_title,icon:V.favicon}}),(o,t)=>{var J,U,L,P,T,D,F;const C=I("router-link");return p(),y("div",fe,[s("header",ye,[l(e(ie),{class:"h-7",items:[{label:o.__("Jobs"),route:{name:"Jobs"}},{label:(J=e(a).data)==null?void 0:J.job_title,route:{name:"JobDetail",params:{job:(U=e(a).data)==null?void 0:U.name}}}]},null,8,["items"]),(L=e(u).data)!=null&&L.name&&!e($)?(p(),y("div",ve,[e(u).data.name==((P=e(a).data)==null?void 0:P.owner)?(p(),f(C,{key:0,to:{name:"JobForm",params:{jobName:(T=e(a).data)==null?void 0:T.name}}},{default:i(()=>[l(e(w),null,{prefix:i(()=>[l(e(K),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[m(" "+n(o.__("Edit")),1)]),_:1})]),_:1},8,["to"])):x("",!0),l(e(w),{onClick:t[0]||(t[0]=b=>{var k;return S((k=e(a).data)==null?void 0:k.company_website)})},{prefix:i(()=>[l(e(Q),{class:"h-4 w-4 stroke-1.5"})]),default:i(()=>[m(" "+n(o.__("Visit Website")),1)]),_:1}),(D=e(_).data)!=null&&D.length?(p(),f(e(h),{key:2,variant:"subtle",theme:"green",size:"lg"},{prefix:i(()=>[l(e(Z),{class:"h-4 w-4"})]),default:i(()=>[m(" "+n(o.__("You have applied")),1)]),_:1})):(p(),f(e(w),{key:1,variant:"solid",onClick:t[1]||(t[1]=b=>d())},{prefix:i(()=>[l(e(X),{class:"h-4 w-4"})]),default:i(()=>[m(" "+n(o.__("Apply")),1)]),_:1}))])):e($)?x("",!0):(p(),y("div",ge,[l(e(w),{onClick:t[2]||(t[2]=b=>{var k;return r((k=e(a).data)==null?void 0:k.name)})},{default:i(()=>[s("span",null,n(o.__("Login to apply")),1)]),_:1})]))]),e(a).data?(p(),y("div",ke,[s("div",xe,[s("div",he,[s("div",we,[s("img",{src:e(a).data.company_logo,class:"size-10 rounded-lg object-contain cursor-pointer mr-4",alt:e(a).data.company_name,onClick:t[3]||(t[3]=b=>S(e(a).data.company_website))},null,8,je),s("div",$e,[s("div",ze,n(e(a).data.job_title),1),s("div",Se,n(e(a).data.company_name)+" - "+n(e(a).data.location)+", "+n(e(a).data.country),1)])]),s("div",Ce,[l(e(h),{size:"lg"},{prefix:i(()=>[l(e(ee),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(j)(e(a).data.creation).fromNow()),1)]),_:1}),l(e(h),{size:"lg"},{prefix:i(()=>[l(e(te),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(a).data.type),1)]),_:1}),(F=e(a).data)!=null&&F.work_mode?(p(),f(e(h),{key:0,size:"lg"},{prefix:i(()=>[l(e(ae),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(a).data.work_mode),1)]),_:1})):x("",!0),e(c).data?(p(),f(e(h),{key:1,size:"lg"},{prefix:i(()=>[l(e(se),{class:"size-3 stroke-2 text-ink-gray-7"})]),default:i(()=>[m(" "+n(e(c).data)+" "+n(e(c).data==1?o.__("applicant"):o.__("applicants")),1)]),_:1})):x("",!0)])]),s("div",Me,[t[6]||(t[6]=s("div",{class:"bg-surface-gray-2 h-px m-1 w-1/2"},null,-1)),s("div",null,[l(e(R),{class:"size-3 stroke-1 text-ink-gray-5"})]),t[7]||(t[7]=s("div",{class:"bg-surface-gray-2 h-px m-1 w-1/2"},null,-1))]),s("p",{innerHTML:e(a).data.description,class:"ProseMirror prose prose-table:table-fixed prose-td:p-2 prose-th:p-2 prose-td:border prose-th:border prose-td:border-outline-gray-2 prose-th:border-outline-gray-2 prose-td:relative prose-th:relative prose-th:bg-surface-gray-2 prose-sm max-w-none !whitespace-normal mt-12"},null,8,Ve)]),l(be,{modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=b=>g.value=b),application:e(_),"onUpdate:application":t[5]||(t[5]=b=>oe(_)?_.value=b:null),job:e(a).data.name},null,8,["modelValue","application","job"])])):x("",!0)])}}};export{Ue as default};
//# sourceMappingURL=JobDetail-BUFktrNO.js.map
