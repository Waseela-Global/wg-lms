import{_ as H}from"./EmptyState.vue_vue_type_script_setup_true_lang-Cua88j6p.js";import{d as j,s as T,v as z,y as w,J as N,eW as K,a as p,o as i,e as r,t as g,ak as R,F as S,g as M,bM as W,b as V,eI as X,f as o,u as l,q as h,w as n,b3 as Y,am as B,l as k,P as O,H as q,B as A,r as F,h as L,eX as Q,cg as J,L as U,ai as Z,D as ee,a8 as $,x as se,i as te,p as ae,z as le,A as oe,E as re,ab as ne}from"./index-CZIp1LU6.js";import{_ as ie}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";const ue={class:"text-xs text-ink-gray-5 mb-2"},ce={class:"overflow-x-auto border rounded-md"},de=["onUpdate:modelValue"],me={key:0,class:"absolute right-[30px] top-5 mt-1 w-32 bg-surface-white border border-outline-gray-1 rounded-md shadow-sm"},pe=["onClick"],ge={class:"mt-2"},_e=j({__name:"ChildTable",props:T({modelValue:{},columns:{default:[]},label:{}},{modelValue:{},modelModifiers:{}}),emits:T(["update:modelValue"],["update:modelValue"]),setup(b,{emit:y}){const c=z(b,"modelValue"),d=w(null),f=w(null),m=w(""),C=y,E=w(b.columns);N(c,()=>{var e;((e=c.value)==null?void 0:e.length)<1&&P()});const P=()=>{c.value||(c.value=[]);let e={};E.value.forEach(s=>{e[s.toLowerCase().split(" ").join("_")]=""}),c.value.push(e),C("update:modelValue",c.value)},x=e=>{c.value.splice(e,1),C("update:modelValue",c.value)},D=()=>[...Array(E.value.length).fill("1fr"),"0.25fr"].join(" "),_=(e,s)=>{f.value=f.value===e?null:e,m.value=`${s.clientY+10}px`};K(d,()=>{f.value=null});const v=e=>E.value.map(t=>t.toLowerCase().split(" ").join("_")).includes(e);return(e,s)=>(i(),p("div",null,[r("div",ue,g(b.label),1),r("div",ce,[r("div",{class:"grid items-center space-x-4 p-2 border-b",style:R({gridTemplateColumns:D()})},[(i(!0),p(S,null,M(E.value,(t,a)=>(i(),p("div",{key:a,class:"text-sm text-ink-gray-5"},g(t),1))),128)),s[0]||(s[0]=r("div",null,null,-1))],4),(i(!0),p(S,null,M(c.value,(t,a)=>(i(),p("div",{key:a,class:"grid items-center space-x-4 p-2",style:R({gridTemplateColumns:D()})},[(i(!0),p(S,null,M(Object.keys(t),u=>(i(),p(S,{key:u},[v(u)?W((i(),p("input",{key:0,"onUpdate:modelValue":G=>t[u]=G,class:"py-1.5 px-2 border-none focus:ring-0 focus:border focus:border-gray-300 focus:bg-surface-gray-2 rounded-sm text-sm focus:outline-none"},null,8,de)),[[X,t[u]]]):V("",!0)],64))),128)),r("div",{class:"relative",ref_for:!0,ref_key:"menuRef",ref:d},[o(l(h),{variant:"ghost",onClick:u=>_(a,u)},{icon:n(()=>[o(l(Y),{class:"size-4 text-ink-gray-7 stroke-1.5 cursor-pointer"})]),_:1},8,["onClick"]),f.value===a?(i(),p("div",me,[r("button",{onClick:u=>x(a),class:"flex items-center space-x-2 w-full text-left px-3 py-2 text-sm text-ink-red-3"},[o(l(B),{class:"size-4 stroke-1.5"}),r("span",null,g(e.__("Delete")),1)],8,pe)])):V("",!0)],512)],4))),128))]),r("div",ge,[o(l(h),{onClick:P},{prefix:n(()=>[o(l(O),{class:"size-4 text-ink-gray-7"})]),default:n(()=>[k(" "+g(e.__("Add Row")),1)]),_:1})])]))}}),ve={class:"text-xl font-semibold text-ink-gray-9"},xe={class:"grid grid-cols-2 gap-10"},fe={class:"space-y-4"},be={class:"text-xs text-ink-gray-5 mb-2"},ye={class:"flex justify-end space-x-2 group"},ke=j({__name:"ProgrammingExerciseForm",props:T({exerciseID:{default:"new"}},{modelValue:{},modelModifiers:{},exercises:{},exercisesModifiers:{}}),emits:["update:modelValue","update:exercises"],setup(b){const y=z(b,"modelValue"),c=z(b,"exercises"),d=w({title:"",language:"Python",problem_statement:"",test_cases:[]}),f=[{label:"Python",value:"Python"},{label:"JavaScript",value:"JavaScript"}],m=b;N(()=>m.exerciseID,()=>{C(),E()});const C=()=>{var s;let e=!0;(s=c.value)==null||s.data.forEach(t=>{t.name===m.exerciseID&&(e=!1,d.value={...t})}),e&&(d.value={title:"",language:"Python",problem_statement:"",test_cases:[]})},I=q({doctype:"LMS Test Case",fields:["input","expected_output","name"],cache:["testCases",m.exerciseID],parent:"LMS Programming Exercise",onSuccess(e){d.value.test_cases=e}}),E=()=>{I.update({filters:{parent:m.exerciseID,parenttype:"LMS Programming Exercise",parentfield:"test_cases"}}),I.reload()},P=e=>{m.exerciseID=="new"?x(e):D(e)},x=e=>{var s;(s=c.value)==null||s.insert.submit({...d.value},{onSuccess(){var t;e(),(t=c.value)==null||t.reload(),$.success(__("Programming Exercise created successfully"))},onError(t){var a;$.warning(__(((a=t.messages)==null?void 0:a[0])||t))}})},D=e=>{var s;(s=c.value)==null||s.setValue.submit({name:m.exerciseID,...d.value},{onSuccess(){var t;e(),(t=c.value)==null||t.reload(),$.success(__("Programming Exercise updated successfully"))},onError(t){var a;$.warning(__(((a=t.messages)==null?void 0:a[0])||t))}})},_=A(()=>["Input","Expected Output"]),v=e=>{var s;m.exerciseID!="new"&&((s=c.value)==null||s.delete.submit(m.exerciseID,{onSuccess(){$.success(__("Programming Exercise deleted successfully")),e()},onError(t){var a;$.warning(__(((a=t.messages)==null?void 0:a[0])||t))}}))};return(e,s)=>{const t=F("router-link");return i(),L(l(ee),{modelValue:y.value,"onUpdate:modelValue":s[4]||(s[4]=a=>y.value=a),options:{size:"5xl"}},{"body-title":n(()=>[r("div",ve,g(m.exerciseID==="new"?e.__("Create Programming Exercise"):e.__("Edit Programming Exercise")),1)]),"body-content":n(()=>[r("div",xe,[r("div",fe,[o(l(U),{modelValue:d.value.title,"onUpdate:modelValue":s[0]||(s[0]=a=>d.value.title=a),label:e.__("Title"),required:!0},null,8,["modelValue","label"]),o(l(U),{modelValue:d.value.language,"onUpdate:modelValue":s[1]||(s[1]=a=>d.value.language=a),label:e.__("Language"),type:"select",options:f,required:!0},null,8,["modelValue","label"]),o(_e,{modelValue:d.value.test_cases,"onUpdate:modelValue":s[2]||(s[2]=a=>d.value.test_cases=a),label:e.__("Test Cases"),columns:_.value,required:!0,addable:!0,deletable:!0,editable:!0,placeholder:e.__("Add Test Case")},null,8,["modelValue","label","columns","placeholder"])]),r("div",null,[r("div",null,[r("div",be,[k(g(e.__("Problem Statement"))+" ",1),s[5]||(s[5]=r("span",{class:"text-ink-red-3"},"*",-1))]),o(l(Z),{content:d.value.problem_statement,onChange:s[3]||(s[3]=a=>d.value.problem_statement=a),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[21rem] overflow-y-auto"},null,8,["content"])])])])]),actions:n(({close:a})=>[r("div",ye,[b.exerciseID!="new"?(i(),L(l(h),{key:0,onClick:u=>v(a),variant:"outline",theme:"red",class:"invisible group-hover:visible"},{prefix:n(()=>[o(l(B),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(e.__("Delete")),1)]),_:1},8,["onClick"])):V("",!0),o(t,{to:{name:"ProgrammingExerciseSubmission",params:{exerciseID:m.exerciseID,submissionID:"new"}}},{default:n(()=>[o(l(h),null,{prefix:n(()=>[o(l(Q),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(e.__("Test this Exercise")),1)]),_:1})]),_:1},8,["to"]),o(t,{to:{name:"ProgrammingExerciseSubmissions",query:{exercise:m.exerciseID}}},{default:n(()=>[o(l(h),null,{prefix:n(()=>[o(l(J),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(e.__("Check Submission")),1)]),_:1})]),_:1},8,["to"]),o(l(h),{variant:"solid",onClick:u=>P(a)},{default:n(()=>[k(g(e.__("Save")),1)]),_:1},8,["onClick"])])]),_:1},8,["modelValue"])}}}),he={class:"sticky flex items-center justify-between top-0 z-10 border-b bg-surface-white px-3 py-2.5 sm:px-5"},Ce={class:"space-x-2"},Ee={class:"md:w-4/5 md:mx-auto p-5"},we={class:"flex items-center justify-between mb-5"},Ve={key:0,class:"text-lg font-semibold text-ink-gray-9"},Pe={key:1,class:"grid grid-cols-2 gap-5"},De={key:0,class:"grid grid-cols-1 md:grid-cols-3 gap-4"},$e=["onClick"],Se={class:"text-lg font-semibold text-ink-gray-9"},Ie={class:"text-sm text-ink-gray-7"},Me={key:2,class:"flex justify-center my-5"},je=j({__name:"ProgrammingExercises",setup(b){const y=w(0),c=window.read_only_mode,{brand:d}=se(),f=w(!1),m=w("new"),C=te("$user"),I=ae();le(()=>{E(),P()});const E=()=>{var _,v,e;!((_=C.data)!=null&&_.is_instructor)&&!((v=C.data)!=null&&v.is_moderator)&&!((e=C.data)!=null&&e.is_evaluator)&&I.push({name:"ProgrammingExerciseSubmissions"})},P=()=>{oe("frappe.client.get_count",{doctype:"LMS Programming Exercise"}).then(_=>{y.value=_}).catch(_=>{console.error("Error fetching exercise count:",_)})},x=q({doctype:"LMS Programming Exercise",cache:["programmingExercises"],fields:["name","title","language","problem_statement"],auto:!0,orderBy:"modified desc"});re(()=>({title:__("Programming Exercises"),icon:d.favicon}));const D=A(()=>[{label:__("Programming Exercises"),route:{name:"ProgrammingExercises"}}]);return(_,v)=>{var t,a;const e=F("router-link"),s=H;return i(),p(S,null,[r("header",he,[o(l(ie),{items:D.value},null,8,["items"]),r("div",Ce,[o(e,{to:{name:"ProgrammingExerciseSubmissions"}},{default:n(()=>[o(l(h),null,{prefix:n(()=>[o(l(J),{class:"size-4 stroke-1.5"})]),default:n(()=>[k(" "+g(_.__("Check All Submissions")),1)]),_:1})]),_:1}),l(c)?V("",!0):(i(),L(l(h),{key:0,variant:"solid",onClick:v[0]||(v[0]=()=>{m.value="new",f.value=!0})},{prefix:n(()=>[o(l(O),{class:"h-4 w-4 stroke-1.5"})]),default:n(()=>[k(" "+g(_.__("Create")),1)]),_:1}))])]),r("div",Ee,[r("div",we,[y.value?(i(),p("div",Ve,g(_.__("{0} Exercises").format(y.value)),1)):V("",!0),(t=l(x).data)!=null&&t.length||y.value>0?(i(),p("div",Pe)):V("",!0)]),(a=l(x).data)!=null&&a.length?(i(),p("div",De,[(i(!0),p(S,null,M(l(x).data,u=>(i(),p("div",{key:u.name,onClick:()=>{m.value=u.name,f.value=!0},class:"flex flex-col border rounded-md p-3 h-full hover:border-outline-gray-3 space-y-2 cursor-pointer"},[r("div",Se,g(u.title),1),r("div",Ie,g(u.language),1)],8,$e))),128))])):(i(),L(s,{key:1,type:"Programming Exercises"})),l(x).data&&l(x).hasNextPage?(i(),p("div",Me,[o(l(h),{onClick:v[1]||(v[1]=u=>l(x).next())},{default:n(()=>[k(g(_.__("Load More")),1)]),_:1})])):V("",!0)]),o(ke,{modelValue:f.value,"onUpdate:modelValue":v[2]||(v[2]=u=>f.value=u),exerciseID:m.value,exercises:l(x),"onUpdate:exercises":v[3]||(v[3]=u=>ne(x)?x.value=u:null)},null,8,["modelValue","exerciseID","exercises"])],64)}}});export{je as default};
//# sourceMappingURL=ProgrammingExercises-DOOoxetk.js.map
