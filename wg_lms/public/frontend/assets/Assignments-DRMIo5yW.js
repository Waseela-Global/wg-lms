import{d as N,s as E,v as S,aa as z,J as F,B as h,r as O,h as D,o as g,w as v,e as c,t as y,f as r,u as s,L as $,l as A,ai as Q,b as x,q as I,D as H,a8 as M,i as T,y as V,x as J,p as G,z as K,H as W,A as X,E as Y,a as C,P as Z,Q as ee,ab as se,F as te}from"./index-CZIp1LU6.js";import{_ as ae}from"./Breadcrumbs.vue_vue_type_script_setup_true_lang-B2fdcvTt.js";import{_ as ne}from"./EmptyState.vue_vue_type_script_setup_true_lang-Cua88j6p.js";const le={class:"p-5 text-base"},oe={class:"text-lg text-ink-gray-9 font-semibold mb-5"},ie={class:"space-y-4 max-h-[75vh] overflow-y-auto"},ue={class:"text-xs text-ink-gray-5 mb-2"},re={class:"flex justify-end space-x-2 mt-5"},me=N({__name:"AssignmentForm",props:E({assignmentID:{type:String,default:"new"}},{modelValue:{},modelModifiers:{},assignments:{},assignmentsModifiers:{}}),emits:["update:modelValue","update:assignments"],setup(f){const p=S(f,"modelValue"),b=S(f,"assignments"),t=z({title:"",type:"",question:""}),o=f;F(()=>o.assignmentID,n=>{var l;n!=="new"&&((l=b.value)==null||l.data.forEach(i=>{i.name===n&&(t.title=i.title,t.type=i.type,t.question=i.question)}))},{flush:"post"});const _=()=>{o.assignmentID=="new"?b.value.insert.submit({...t},{onSuccess(){p.value=!1,M.success(__("Assignment created successfully"))}}):b.value.setValue.submit({...t,name:o.assignmentID},{onSuccess(){p.value=!1,M.success(__("Assignment updated successfully"))}})},w=h(()=>[{label:"PDF",value:"PDF"},{label:"Image",value:"Image"},{label:"Document",value:"Document"},{label:"Text",value:"Text"},{label:"URL",value:"URL"}]);return(n,l)=>{const i=O("router-link");return g(),D(s(H),{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=m=>p.value=m),options:{size:"lg"}},{body:v(()=>[c("div",le,[c("div",oe,y(f.assignmentID==="new"?n.__("Create an Assignment"):n.__("Edit Assignment")),1),c("div",ie,[r(s($),{modelValue:t.title,"onUpdate:modelValue":l[0]||(l[0]=m=>t.title=m),label:n.__("Title"),required:!0},null,8,["modelValue","label"]),r(s($),{modelValue:t.type,"onUpdate:modelValue":l[1]||(l[1]=m=>t.type=m),type:"select",options:w.value,label:n.__("Submission Type"),required:!0},null,8,["modelValue","options","label"]),c("div",null,[c("div",ue,[A(y(n.__("Question"))+" ",1),l[4]||(l[4]=c("span",{class:"text-ink-red-3"},"*",-1))]),r(s(Q),{content:t.question,onChange:l[2]||(l[2]=m=>t.question=m),editable:!0,fixedMenu:!0,editorClass:"prose-sm max-w-none border-b border-x bg-surface-gray-2 rounded-b-md py-1 px-2 min-h-[7rem] max-h-[18rem] overflow-y-auto"},null,8,["content"])])]),c("div",re,[r(i,{to:{name:"AssignmentSubmissionList",query:{assignmentID:f.assignmentID}}},{default:v(()=>[f.assignmentID!=="new"?(g(),D(s(I),{key:0,variant:"subtle"},{default:v(()=>[A(y(n.__("Check Submissions")),1)]),_:1})):x("",!0)]),_:1},8,["to"]),r(s(I),{variant:"solid",onClick:_},{default:v(()=>[A(y(n.__("Save")),1)]),_:1})])])]),_:1},8,["modelValue"])}}}),de={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-surface-white px-3 py-2.5 sm:px-5"},ce={class:"md:w-3/4 md:mx-auto py-5 mx-5"},pe={class:"flex items-center justify-between mb-5"},ge={key:0,class:"text-lg font-semibold text-ink-gray-9"},fe={key:1,class:"grid grid-cols-2 gap-5"},ve={key:2,class:"flex justify-center my-5"},we={__name:"Assignments",setup(f){const p=T("$user"),b=T("$dayjs"),t=V(""),o=V(""),_=V(!1),w=V("new"),n=V(0),{brand:l}=J(),i=G(),m=window.read_only_mode;K(()=>{var a,e;!((a=p.data)!=null&&a.is_moderator)&&!((e=p.data)!=null&&e.is_instructor)&&i.push({name:"Courses"}),j(),t.value=i.currentRoute.value.query.title,o.value=i.currentRoute.value.query.type}),F([t,o],()=>{i.push({query:{title:t.value,type:o.value}}),U()});const U=()=>{u.update({filters:L.value}),u.reload()},L=h(()=>{var e,k;let a={};return t.value&&(a.title=["like",`%${t.value}%`]),o.value&&(a.type=o.value),(e=p.data)!=null&&e.is_moderator||(a.owner=(k=p.data)==null?void 0:k.email),a}),u=W({doctype:"LMS Assignment",fields:["name","title","type","creation","question"],orderBy:"modified desc",cache:["assignments"],transform(a){return a.map(e=>({...e,creation:b(e.creation).fromNow()}))}}),R=h(()=>[{label:__("Title"),key:"title",width:2},{label:__("Type"),key:"type",width:1,align:"left"},{label:__("Created"),key:"creation",width:1,align:"right"}]),j=()=>{X("frappe.client.get_count",{doctype:"LMS Assignment"}).then(a=>{n.value=a})},P=h(()=>["","Document","Image","PDF","URL","Text"].map(e=>({label:__(e),value:e}))),B=h(()=>[{label:"Assignments",route:{name:"Assignments"}}]);return Y(()=>({title:__("Assignments"),icon:l.favicon})),(a,e)=>{var k,q;return g(),C(te,null,[c("header",de,[r(s(ae),{items:B.value},null,8,["items"]),s(m)?x("",!0):(g(),D(s(I),{key:0,variant:"solid",onClick:e[0]||(e[0]=()=>{w.value="new",_.value=!0})},{prefix:v(()=>[r(s(Z),{class:"w-4 h-4"})]),default:v(()=>[A(" "+y(a.__("Create")),1)]),_:1}))]),c("div",ce,[c("div",pe,[n.value?(g(),C("div",ge,y(a.__("{0} Assignments").format(n.value)),1)):x("",!0),(k=s(u).data)!=null&&k.length||n.value>0?(g(),C("div",fe,[r(s($),{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=d=>t.value=d),placeholder:a.__("Search by title")},null,8,["modelValue","placeholder"]),r(s($),{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=d=>o.value=d),type:"select",options:P.value,placeholder:a.__("Type")},null,8,["modelValue","options","placeholder"])])):x("",!0)]),(q=s(u).data)!=null&&q.length?(g(),D(s(ee),{key:0,columns:R.value,rows:s(u).data,"row-key":"name",options:{showTooltip:!1,selectable:!1,onRowClick:d=>{s(m)||(w.value=d.name,_.value=!0)}}},null,8,["columns","rows","options"])):(g(),D(ne,{key:1,type:"Assignments"})),s(u).data&&s(u).hasNextPage?(g(),C("div",ve,[r(s(I),{onClick:e[3]||(e[3]=d=>s(u).next())},{default:v(()=>[A(y(a.__("Load More")),1)]),_:1})])):x("",!0)]),r(me,{modelValue:_.value,"onUpdate:modelValue":e[4]||(e[4]=d=>_.value=d),assignments:s(u),"onUpdate:assignments":e[5]||(e[5]=d=>se(u)?u.value=d:null),assignmentID:w.value},null,8,["modelValue","assignments","assignmentID"])],64)}}};export{we as default};
//# sourceMappingURL=Assignments-DRMIo5yW.js.map
